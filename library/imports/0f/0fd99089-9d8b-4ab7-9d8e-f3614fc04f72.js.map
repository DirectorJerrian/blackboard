{"version":3,"sources":["..\\..\\..\\assets/assets\\activityBar.js"],"names":["cc","Class","extends","Component","properties","scrollview","ScrollView","eventPrefab","default","type","Prefab","onLoad","_http","http","accountNode","director","getScene","getChildByName","account","getComponent","getid","i","newEvent","instantiate","getComponentsInChildren","Label","string","content","addChild","setPosition","v2","get","res","j","childrenCount","children","destroy","data","length","title","time1","Date","startTime","toLocaleDateString","time2","endTime","poster_url","randomx","Math","ceil","random","scrollToOffset","setContentPosition","node","on","position","getContentPosition","y","brake","start"],"mappings":"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","file":"activityBar.js","sourceRoot":"..\\..\\..\\assets","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport http from \"./http\"; //引入模块\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        scrollview:cc.ScrollView,\r\n        eventPrefab:{\r\n            default:null,\r\n            type:cc.Prefab\r\n        },\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad:function () {\r\n        let _http = new http();\r\n        var accountNode = cc.director.getScene().getChildByName('Account');\r\n        var account = accountNode.getComponent('account');\r\n\r\n        if(account.getid()==null){\r\n            for(var i=0;i<4;i++){\r\n                var newEvent = cc.instantiate(this.eventPrefab);\r\n                if(i=3){\r\n                    newEvent.getComponentsInChildren(cc.Label)[0].string=\"Please login first！\";\r\n                }\r\n                this.scrollview.content.addChild(newEvent);\r\n                newEvent.setPosition(cc.v2(50,-300-i*160));\r\n            }\r\n        }else{\r\n            _http.get(\"/activity/public\",{},(res)=>{\r\n                var j=1;\r\n                while(j<this.scrollview.content.childrenCount){\r\n                    this.scrollview.content.children[j].destroy();\r\n                    j++;\r\n                }\r\n                for(var i=0;i<res.data.length;i++){\r\n                    var newEvent = cc.instantiate(this.eventPrefab);\r\n                    newEvent.getComponentsInChildren(cc.Label)[0].string=(i+1)+\".\"+res.data[i].title;\r\n                    var time1=new Date(res.data[i].startTime).toLocaleDateString();\r\n                    var time2=new Date(res.data[i].endTime).toLocaleDateString();\r\n                    newEvent.getComponentsInChildren(cc.Label)[1].string=\"● Time:\"+time1+\"\\n~\"+time2;\r\n                    newEvent.getComponentsInChildren(cc.Label)[2].string=\"● Address:\"+res.data[i].poster_url;\r\n                    newEvent.getComponentsInChildren(cc.Label)[3].string=\"● Content:\"+res.data[i].content;\r\n                    this.scrollview.content.addChild(newEvent);\r\n                    var randomx=50+Math.ceil(Math.random()*130);\r\n                    newEvent.setPosition(cc.v2(randomx,-300-i*420));\r\n                }\r\n            \r\n                this.scrollview.scrollToOffset(cc.v2(0,201),0.5);\r\n            });\r\n        }\r\n        this.scrollview.setContentPosition(cc.v2(0,200));\r\n        this.scrollview.node.on('scrolling',function(){\r\n            var position=this.scrollview.getContentPosition();\r\n            if(position.y<200){\r\n                this.scrollview.brake=1;\r\n            }\r\n        },this);\r\n        this.scrollview.node.on('scroll-ended',function(){\r\n            this.scrollview.brake=0.9;\r\n            var position=this.scrollview.getContentPosition();\r\n            if(position.y<100){\r\n                if(account.getid()==null){\r\n                    var j=1;\r\n                    while(j<this.scrollview.content.childrenCount){\r\n                        this.scrollview.content.children[j].destroy();\r\n                        j++;\r\n                    }\r\n                    for(var i=0;i<4;i++){\r\n                        var newEvent = cc.instantiate(this.eventPrefab);\r\n                        if(i=3){\r\n                            newEvent.getComponentsInChildren(cc.Label)[0].string=\"Please login first！\";\r\n                        }\r\n                        this.scrollview.content.addChild(newEvent);\r\n                        newEvent.setPosition(cc.v2(50,-300-i*160));\r\n                    }\r\n                    this.scrollview.scrollToOffset(cc.v2(0,201),0.5);\r\n                }else{\r\n                    _http.get(\"/activity/public\",{},(res)=>{\r\n                        var j=1;\r\n                        while(j<this.scrollview.content.childrenCount){\r\n                            this.scrollview.content.children[j].destroy();\r\n                            j++;\r\n                        }\r\n                        for(var i=0;i<res.data.length;i++){\r\n                            var newEvent = cc.instantiate(this.eventPrefab);\r\n                            newEvent.getComponentsInChildren(cc.Label)[0].string=(i+1)+\".\"+res.data[i].title;\r\n                            var time1=new Date(res.data[i].startTime).toLocaleDateString();\r\n                            var time2=new Date(res.data[i].endTime).toLocaleDateString();\r\n                            newEvent.getComponentsInChildren(cc.Label)[1].string=\"● Time:\"+time1+\"\\n~\"+time2;\r\n                            newEvent.getComponentsInChildren(cc.Label)[2].string=\"● Address:\"+res.data[i].poster_url;\r\n                            newEvent.getComponentsInChildren(cc.Label)[3].string=\"● Content:\"+res.data[i].content;\r\n                            this.scrollview.content.addChild(newEvent);\r\n                            var randomx=50+Math.ceil(Math.random()*130);\r\n                            newEvent.setPosition(cc.v2(randomx,-300-i*420));\r\n                        }\r\n                    \r\n                        this.scrollview.scrollToOffset(cc.v2(0,201),0.5);\r\n                    });\r\n                }\r\n            }else if(position.y<200){\r\n                this.scrollview.scrollToOffset(cc.v2(0,201),0.5);\r\n            }\r\n        },this);\r\n    },\r\n\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n\r\n    //update:function (dt) {},\r\n});\r\n"]}